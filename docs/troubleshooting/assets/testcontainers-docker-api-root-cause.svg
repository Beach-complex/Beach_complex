<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="1700" viewBox="0 0 1000 1700">
  <defs>
    <marker id="arrow" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path class="arrow-head" d="M0,0 L12,4 L0,8 Z"/>
    </marker>
    <style>
      :root {
        --title-color: #111827;
        --title-bg-fill: #f1f5f9;
        --title-bg-stroke: #cbd5e1;
        --text-color: #111827;
        --small-color: #374151;
        --box-fill: #f8fafc;
        --box-stroke: #1f2937;
        --warn-fill: #fff1f2;
        --warn-stroke: #b91c1c;
        --ok-fill: #ecfdf5;
        --ok-stroke: #047857;
        --line-color: #0ea5e9;
        --line-outline: #082f49;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --title-color: #f9fafb;
          --title-bg-fill: #0f172a;
          --title-bg-stroke: #e2e8f0;
          --text-color: #f9fafb;
          --small-color: #e5e7eb;
          --box-fill: #1f2937;
          --box-stroke: #cbd5e1;
          --warn-fill: #3f1d24;
          --warn-stroke: #fca5a5;
          --ok-fill: #052e1d;
          --ok-stroke: #6ee7b7;
          --line-color: #38bdf8;
          --line-outline: #e2e8f0;
        }
      }

      .title-bg { fill: var(--title-bg-fill); stroke: var(--title-bg-stroke); stroke-width: 1.6; rx: 12; }
      .title { font: 700 34px 'Noto Sans KR','Malgun Gothic','Apple SD Gothic Neo',Arial,sans-serif; fill: var(--title-color); }
      .box { fill: var(--box-fill); stroke: var(--box-stroke); stroke-width: 2.2; rx: 12; }
      .warn { fill: var(--warn-fill); stroke: var(--warn-stroke); stroke-width: 2.2; rx: 12; }
      .ok { fill: var(--ok-fill); stroke: var(--ok-stroke); stroke-width: 2.2; rx: 12; }
      .text { font: 600 24px 'Noto Sans KR','Malgun Gothic','Apple SD Gothic Neo',Arial,sans-serif; fill: var(--text-color); }
      .small { font: 500 20px 'Noto Sans KR','Malgun Gothic','Apple SD Gothic Neo',Arial,sans-serif; fill: var(--small-color); }
      .line { stroke: var(--line-color); stroke-width: 3.6; stroke-linecap: round; marker-end: url(#arrow); }
      .arrow-head { fill: var(--line-color); stroke: var(--line-outline); stroke-width: 1.2; }
    </style>
  </defs>

  <rect x="120" y="14" width="760" height="56" class="title-bg"/>
  <text x="500" y="52" text-anchor="middle" class="title">시각화 1: 실패 메커니즘(원인 경로)</text>

  <rect x="120" y="95" width="760" height="88" class="box"/>
  <text x="500" y="149" text-anchor="middle" class="text">1) Gradle test 시작</text>

  <line x1="500" y1="183" x2="500" y2="230" class="line"/>

  <rect x="120" y="230" width="760" height="88" class="box"/>
  <text x="500" y="284" text-anchor="middle" class="text">2) Spring Test Context 초기화</text>

  <line x1="500" y1="318" x2="500" y2="365" class="line"/>

  <rect x="120" y="365" width="760" height="98" class="box"/>
  <text x="500" y="417" text-anchor="middle" class="text">3) Testcontainers Postgres 컨테이너 기동 시도</text>
  <text x="500" y="445" text-anchor="middle" class="small">(TestcontainersConfig 진입)</text>

  <line x1="500" y1="463" x2="500" y2="510" class="line"/>

  <rect x="120" y="510" width="760" height="98" class="box"/>
  <text x="500" y="562" text-anchor="middle" class="text">4) DockerClientProviderStrategy로 Docker 환경 탐색</text>
  <text x="500" y="590" text-anchor="middle" class="small">(UnixSocket 전략 사용)</text>

  <line x1="500" y1="608" x2="500" y2="655" class="line"/>

  <rect x="120" y="655" width="760" height="98" class="warn"/>
  <text x="500" y="707" text-anchor="middle" class="text">5) GET /v1.41/info 호출</text>
  <text x="500" y="735" text-anchor="middle" class="small">Docker Engine 29.x 최소 API는 1.44</text>

  <line x1="500" y1="753" x2="500" y2="800" class="line"/>

  <rect x="120" y="800" width="760" height="98" class="warn"/>
  <text x="500" y="852" text-anchor="middle" class="text">6) Docker가 HTTP 400 반환</text>
  <text x="500" y="880" text-anchor="middle" class="small">BadRequestException 발생</text>

  <line x1="500" y1="898" x2="500" y2="945" class="line"/>

  <rect x="120" y="945" width="760" height="98" class="warn"/>
  <text x="500" y="997" text-anchor="middle" class="text">7) 유효한 Docker 환경 탐색 실패</text>
  <text x="500" y="1025" text-anchor="middle" class="small">("Could not find a valid Docker environment")</text>

  <line x1="500" y1="1043" x2="500" y2="1090" class="line"/>

  <rect x="120" y="1090" width="760" height="98" class="warn"/>
  <text x="500" y="1142" text-anchor="middle" class="text">8) Spring Context 초기화 실패</text>
  <text x="500" y="1170" text-anchor="middle" class="small">BeanCreationException / IllegalStateException</text>

  <line x1="500" y1="1188" x2="500" y2="1235" class="line"/>

  <rect x="120" y="1235" width="760" height="88" class="warn"/>
  <text x="500" y="1289" text-anchor="middle" class="text">9) 통합테스트 및 :test 실패</text>

  <line x1="500" y1="1323" x2="500" y2="1370" class="line"/>

  <rect x="80" y="1370" width="840" height="240" class="ok"/>
  <text x="500" y="1430" text-anchor="middle" class="text">해결 적용</text>
  <text x="500" y="1485" text-anchor="middle" class="text">- testcontainers.version = 1.20.5</text>
  <text x="500" y="1535" text-anchor="middle" class="text">- 테스트 JVM systemProperty: api.version = 1.44</text>
  <text x="500" y="1585" text-anchor="middle" class="text">결과: 통합 테스트 + 전체 test 작업 정상 통과</text>
</svg>
